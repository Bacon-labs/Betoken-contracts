<body style="background-color: #f1f4f6;">
  <div class="ui stackable grid" style="margin-top: 0.02%;">
    <!-- Top Bar -->
    {{> top_bar}}

    <div class="ui container nine wide column">
      <!-- Tabs -->
      <div class="ui top attached tabular menu">
        <a class="item active" data-tab="ranking">Rankings</a>
        <a class="item" data-tab="decisions">My Investments</a>
        <a class="item" data-tab="price">Token Prices</a>
        <a class="item" data-tab="stats">Statistics</a>
      </div>

      <!-- Tab contents -->
      <div class="ui bottom attached tab large-tab segment active" data-tab="ranking">
        {{> ranking_tab}}
      </div>

      <div class="ui bottom attached tab large-tab segment" data-tab="decisions">
        {{> decisions_tab}}
      </div>

      <div class="ui bottom attached tab large-tab segment" data-tab="price">
        {{> price_tab}}
      </div>

      <div class="ui bottom attached tab segment" data-tab="stats">
        {{> stats_tab}}
      </div>
    </div>

    <!-- Sidebar -->
    <div class="ui seven wide column container">
      {{> sidebar}}
    </div>

    <!-- Transaction Message Modal -->
    <div class="ui modal" id="transaction_sent_modal">
      <div class="ui icon header">
        <i class="ui btkgreen checkmark icon"></i>
        <p>You've successfully sent an Ethereum transaction!</p>
        <p>Changes you've just made will be in effect after the transaction has been written to the blockchain.</p>
        <p>You can monitor the status of your transaction here: <a target="_blank" href="https://{{network_prefix}}etherscan.io/tx/{{transaction_hash}}">{{transaction_hash}}</a></p>
      </div>
      <div class="actions">
        <div class="ui ok positive button fluid" style="background-color: #1fdaa6">
          Hooray!
        </div>
      </div>
    </div>

    <!-- Error Message Modal -->
    <div class="ui modal" id="error_modal">
      <div class="ui icon header">
        <i class="ui red warning sign icon"></i>
        <p>{{{error_msg}}}</p>
      </div>
      <div class="actions">
        <div class="ui ok positive button fluid" style="background-color: #1fdaa6">
          Got It
        </div>
      </div>
    </div>

    <!-- Success Message Modal -->
    <div class="ui modal" id="success_modal">
      <div class="ui icon header">
        <i class="ui btkgreen checkmark icon"></i>
        <p>{{success_msg}}</p>
      </div>
      <div class="actions">
        <div class="ui ok positive button fluid" style="background-color: #1fdaa6">
          Hooray!
        </div>
      </div>
    </div>
  </div>
</body>

<template name="top_bar">
  <div class="ui top three item menu">
    <div class="item">
      <a href="https://betoken.fund">
        <img src="https://raw.githubusercontent.com/Betoken/assets/master/logo/betoken-logo.png" style="max-height: 30%; max-width: 30%;">
      </a>
    </div>

    <div class="item">
      {{#if show_countdown}}
        {{> countdown_timer}}
      {{else if paused}}
        <button class="ui negative button emergency_withdraw {{allow_emergency_withdraw}}">
          Withdraw All Funds
        </button>
      {{else}}
        <button class="ui positive button next_phase {{need_web3}}" style="background-color: #1fdaa6">
          Next Phase
        </button>
      {{/if}}
    </div>

    <div class="item">
      <h5>
        <button class="circular ui icon button info_button" style="float: right;">
          <i class="info icon"></i>
        </button>
      </h5>
    </div>
  </div>

  <div class="ui modal" id="contract_info_modal">
    <div class="ui icon header">
      <i class="info icon"></i>
      Advanced Info
    </div>
    <div class="content" style="text-align: center;">
      <h5>
        <p></p>
        Current Network: {{network_name}}
        <p></p>
        BetokenFund: <a target="_blank" href="https://{{network_prefix}}etherscan.io/address/{{betoken_addr}}">{{betoken_addr}}</a>
        <p></p>
        Kairo: <a target="_blank" href="https://{{network_prefix}}etherscan.io/address/{{kairo_addr}}">{{kairo_addr}}</a>
        <p></p>
        Shares: <a target="_blank" href="https://{{network_prefix}}etherscan.io/address/{{shares_addr}}">{{shares_addr}}</a>
        <p></p>
        KyberNetwork: <a target="_blank" href="https://{{network_prefix}}etherscan.io/address/{{kyber_addr}}">{{kyber_addr}}</a>
        <p></p>
        DAI: <a target="_blank" href="https://{{network_prefix}}etherscan.io/address/{{dai_addr}}">{{dai_addr}}</a>
        <p></p>
        TestTokenFactory: <a target="_blank" href="https://{{network_prefix}}etherscan.io/address/{{token_factory_addr}}">{{token_factory_addr}}</a>
      </h5>
    </div>
  </div>
</template>

<template name="countdown_timer">
  <h3>{{phase}}:&nbsp;&nbsp;&nbsp;&nbsp;</h3>
  <div class="ui mini statistics" style="margin-top: 0%;">
    <div class="ui statistic">
      <div class="value">
        {{day}}
      </div>
      <div class="label">
        Days
      </div>
    </div>
    <div class="ui statistic">
      <div class="value">
        {{hour}}
      </div>
      <div class="label">
        Hours
      </div>
    </div>
    <div class="ui statistic">
      <div class="value">
        {{minute}}
      </div>
      <div class="label">
        Minutes
      </div>
    </div>
    <div class="ui statistic">
      <div class="value">
        {{second}}
      </div>
      <div class="label">
        Seconds
      </div>
    </div>
  </div>
</template>


<template name="sidebar">
  <!-- Account Sidebar -->
  <div class="row">
    <h2>My Account</h2>
    <div class="ui menu vertical fluid">
      <div class="ui item">
        <div class="ui horizontal divider">Address</div>
        <h5 style="text-align: center;" class="copyable">{{user_address}}</h5>
      </div>

      <div class="ui item">
        <div class="ui horizontal divider">Investment Balance</div>

        <div class="ui grid stackable">
          <div class="ui container ten wide column">
            <div class="ui mini horizontal statistic">
              <div class="value copyable">
                {{user_balance}}
              </div>
              <div class="label">
                {{balance_unit}}
              </div>
            </div>
          </div>

          <div class="ui container six wide column">
            <div class="ui slider checkbox" style="float: right;">
              <input type="checkbox" class="balance_unit_switch">
              <label>DAI/BTKS</label>
            </div>
          </div>

        </div>
      </div>

      <div class="ui item">
        <div class="ui horizontal divider">Kairo Balance</div>

        <div class="ui grid stackable">
          <div class="ui container ten wide column">
            <div class="ui mini horizontal statistic">
              <div class="value copyable">
                {{user_kairo_balance}}
              </div>
              <div class="label">
                {{kairo_unit}}
              </div>
            </div>
          </div>

          <div class="ui container six wide column">
            <div class="ui slider checkbox" style="float: right;">
              <input type="checkbox" class="kairo_unit_switch">
              <label>KRO/%</label>
            </div>
          </div>
        </div>
      </div>

      <div class="ui item">
        <div class="ui horizontal divider">Expected Commission</div>
        <div class="ui mini horizontal statistic">
          <div class="value copyable">
            {{expected_commission}}
          </div>
          <div class="label">
            DAI
          </div>
        </div>
        {{#if can_redeem_commission}}
          <button class="ui positive button fluid redeem_commission" style="background-color: #1fdaa6">
            Redeem Commission
          </button>
          <p></p>
          <button class="ui positive button fluid redeem_commission_in_shares" style="background-color: #1fdaa6">
            Redeem Commission In Shares
          </button>
        {{/if}}
      </div>
    </div>
  </div>

  <div class="ui horizontal divider"></div>

  <div class="row">
    {{> transact_box}}
  </div>
</template>

<template name="transact_box">
  <!-- Tab buttons -->
  <div class="ui top attached tabular menu">
    <a class="item active header" data-tab="deposit">Deposit</a>
    <a class="item header" data-tab="withdraw">Withdraw</a>
    <a class="item header" data-tab="send_token">Send KRO/BTKS</a>
    <a class="item header" data-tab="history">Records</a>
  </div>

  <!-- Actual Tab Content -->
  <div class="ui bottom attached tab segment scroll active" data-tab="deposit">
    <!--Amount Input-->
    <div class="{{has_error 0}} ui right labeled input fluid">
      <input id="deposit_input" placeholder="Deposit Amount..." type="text">
      <select id="deposit_token_type" class="ui selection compact dropdown">
        <option selected="">DAI</option>
        {{#each token in tokens}}
          <option>{{token}}</option>
        {{/each}}
      </select>
    </div>

    <div class="ui horizontal divider"></div>
    <div class="ui horizontal divider"></div>
    <div class="ui horizontal divider"></div>
    <div class="ui horizontal divider"></div>
    <p></p>
    
    <button class="deposit_button {{is_disabled}} ui primary bottom attached button fluid {{need_web3}}">Deposit</button>
  </div>

  <div class="ui bottom attached tab segment scroll" data-tab="withdraw">
    <!--Amount Input-->
    <div class="{{has_error 1}} ui right labeled input fluid">
      <input id="withdraw_input" placeholder="Withdraw Amount..." type="text">
      <div class="ui label">
        DAI
      </div>
    </div>

    <p></p>
    <b>Into Currency: </b>
    <select id="withdraw_token_type" class="ui selection compact dropdown">
      <option selected="">DAI</option>
        {{#each token in tokens}}
          <option>{{token}}</option>
        {{/each}}
    </select>

    <p></p>
    
    <button class="withdraw_button {{is_disabled}} ui primary button fluid {{need_web3}}">Withdraw</button>
  </div>

  <div class="ui bottom attached tab segment scroll" data-tab="send_token">
    <!--Amount Input-->
    <div class="{{has_error 2}} ui right labeled input fluid">
      <input id="send_token_amount_input" placeholder="Send Amount..." type="text">
      <select id="send_token_type" class="ui selection compact dropdown">
        <option selected="">KRO</option>
        <option>BTKS</option>
      </select>
    </div>

    <p></p>
    
    <div class="{{has_error 3}} ui right input fluid">
      <input id="send_token_recipient_input" placeholder="Recipient Address..." type="text">
    </div>

    <p></p>
    
    <button class="token_send_button ui primary button fluid {{need_web3}}">Send</button>
  </div>

  <div class="ui bottom attached tab segment scroll" data-tab="history">
    <!--History Tab-->
    <div class="ui inverted dimmer {{#if is_loading}} active {{/if}}">
      <div class="ui text loader">Loading</div>
    </div>

    <table class="ui tablet stackable table striped celled sortable">
      <!-- Table header -->
      <thead>
      <tr>
        <th>Type</th>
        <th>Token</th>
        <th>Amount</th>
        <th>Timestamp</th>
      </tr>
      </thead>

      <!-- Actual table rows go here -->
      <tbody>
        {{#each transaction_history}}
          <tr>
            <td>{{type}}</td>
            <td>{{token}}</td>
            <td>{{amount}}</td>
            <td>{{timestamp}}</td>
          </tr>
        {{/each}}
      </tbody>
    </table>
  </div>
</template>

<template name="stats_tab">
    <div class="ui grid stackable">
      <div class="twelve wide column">
        <canvas id="ROIChart" width="400" height="400"></canvas>
      </div>
  
      <div class="four wide column">
        <div style="text-align: center;">
          <div class="ui horizontal divider">Fund Stats</div>
          <div class="ui mini statistic">
            <div class="label">
              Current Fund Value
            </div>
            <div class="value">
              {{fund_value}} DAI
            </div>
          </div>
          <p></p>
          <div class="ui mini statistic">
            <div class="label">
              Current Cycle ROI
            </div>
            <div class="value">
              {{cycle_roi}} %
            </div>
          </div>
          <p></p>
          <div class="ui mini statistic">
            <div class="label">
              Average ROI
            </div>
            <div class="value">
              {{avg_roi}}%
            </div>
          </div>
          <p></p>
          <div class="ui mini statistic">
            <div class="label">
              Cycle Length
            </div>
            <div class="value">
              {{cycle_length}} Days
            </div>
          </div>
          <p></p>
          <div class="ui mini statistic">
            <div class="label">
              Previous Cycle Commission Payout
            </div>
            <div class="value">
              {{prev_commission}} DAI
            </div>
          </div>
          <p></p>
          <div class="ui mini statistic">
            <div class="label">
              Historical Commission Payout
            </div>
            <div class="value">
              {{historical_commission}} DAI
            </div>
          </div>
        </div>
      </div>
    </div>
  </template>

<template name="decisions_tab">
  <div class="ui inverted dimmer {{#if is_loading}} active {{/if}}">
    <div class="ui text loader">Loading</div>
  </div>

  <div class="ui menu">
    <div class="item">
      <div class="ui positive button new_investment {{new_investment_is_disabled}} {{need_web3}}" style="background-color: #1fdaa6">
        New Investment
      </div>
    </div>

    <a class="item refresh">
      <i class="sync icon"></i>
    </a>

    <div class="right item">
      <div class="ui search">
        <div class="ui icon input">
          <input class="prompt" placeholder="Search for token..." type="text">
          <i class="search icon"></i>
        </div>
      </div>
    </div>
  </div>

  <table class="ui tablet stackable table striped celled sortable">
    <!-- Table header -->
    <thead>
    <tr>
      <th>#</th>
      <th>Token</th>
      <th>Current Investment</th>
      <th>Buy Price/DAI</th>
      <th>Sell Price/DAI</th>
      <th>ROI/%</th>
      <th>KRO Change</th>
      <th>Status</th>
      <th>Sell</th>
    </tr>
    </thead>

    <!-- Actual table rows go here -->
    <tbody id="decision_table">
      {{#each investment_list}}
          <tr>
            <td>{{id}}</td>
            <td>
              <h5 style="text-align: center;">
                <a target="_blank" href="https://etherscan.io/address/{{tokenAddress}}">{{tokenSymbol}}</a>
              </h5>
            </td>
            <td>{{investment}} DAI / {{stake}} KRO</td>
            <td>{{wei_to_eth buyPrice}}</td>
            <td>
                {{wei_to_eth sellPrice}}
            </td>
            <td>{{ROI}}</td>
            <td>{{kroChange}}</td>
            <td>
              {{#if isSold}}
                Sold
              {{else}}
                Invested
              {{/if}}
            </td>
            <td>
              <div class="ui yellow icon button {{#if isSold}}disabled{{/if}} sell_investment">
                <i class="dollar sign icon"></i>
              </div>
            </td>
          </tr>
      {{/each}}
    </tbody>
  </table>

  <!--New Proposal Modal-->
  <div class="ui modal" id="new_investment_modal">
    <div class="ui icon header">
      <i class="dollar icon"></i>
      Invest in a token for the fund
    </div>
    <div class="content">
      <select id="invest_token_type" class="ui selection fluid dropdown">
        {{#each token in tokens}}
          <option>{{token}}</option>
        {{/each}}
      </select>
      <div class="ui horizontal divider">
        <a target="_blank" href="https://www.cryptocompare.com/coins/{{selected_token}}/overview/DAI">
          Current Price: {{selected_token_price}} DAI
        </a>
      </div>       
      <div class="ui left fluid input">
        <input id="stake_input_new"  placeholder="How much KRO would you bet that this token will perform the best?" type="text">
      </div>
    </div>
    <div class="actions">
      <div class="ui ok positive button fluid" style="background-color: #1fdaa6">
        Invest
      </div>
    </div>
  </div>
</template>

<template name="ranking_tab">
  <div class="ui inverted dimmer {{#if is_loading}} active {{/if}}">
      <div class="ui text loader">Loading</div>
  </div>

  <div class="ui menu">
    <a class="item goto_my_rank">
      <h4> My Rank: {{user_rank}} </h4>
    </a>
    <a class="item goto_my_rank">
      <h4> My Kairo: {{user_value}} </h4>
    </a>

    <a class="item refresh">
      <i class="sync icon"></i>
    </a>

    <div class="right item">
      <div class="ui search">
        <div class="ui icon input">
          <input class="prompt" placeholder="Search for address..." type="text">
          <i class="search icon"></i>
        </div>
      </div>
    </div>
  </div>

  <table class="ui tablet stackable table striped celled sortable">
    <!-- Table header -->
    <thead>
    <tr>
      <th style="text-align: center;">#</th>
      <th>Manager Address</th>
      <th style="text-align: center;">Kairo Balance + Portfolio Value</th>
    </tr>
    </thead>

    <!-- Actual table rows go here -->
    <tbody id="ranking_table">
      {{#each kairo_ranking}}
        <tr>
          <td style="text-align: center;">{{rank}}</td>
          <td>{{address}}</td>
          <td style="text-align: center;">{{kairoBalance}}</td>
        </tr>
      {{/each}}
    </tbody>
  </table>
</template>

<template name="price_tab">
    <div class="ui inverted dimmer {{#if is_loading}} active {{/if}}">
      <div class="ui text loader">Loading</div>
  </div>

  <div class="ui menu">
    <a class="item refresh">
      <i class="sync icon"></i>
    </a>

    <div class="right item">
      <div class="ui search">
        <div class="ui icon input">
          <input class="prompt" placeholder="Search for token..." type="text">
          <i class="search icon"></i>
        </div>
      </div>
    </div>
  </div>

  <table class="ui tablet stackable table striped celled sortable" style="text-align: center;">
    <!-- Table header -->
    <thead>
    <tr>
      <th>Token Symbol</th>
      <th>Current Price/DAI</th>
      <th>CryptoCompare</th>
    </tr>
    </thead>

    <!-- Actual table rows go here -->
    <tbody id="price_table">
      {{#each prices}}
        <tr>
          <td>{{token_symbol}}</td>
          <td>{{price}}</td>
          <td><a target="_blank" href="https://www.cryptocompare.com/coins/{{token_symbol}}/overview/DAI">{{token_symbol}}'s CryptoCompare Page</a></td>
        </tr>
      {{/each}}
    </tbody>
  </table>
</template>