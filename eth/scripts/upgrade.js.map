{
  "version": 3,
  "file": "upgrade.js",
  "sourceRoot": "",
  "sources": [
    "upgrade.coffee"
  ],
  "names": [],
  "mappings": ";AAAA;AAAA,MAAA,WAAA,EAAA,YAAA,EAAA,UAAA,EAAA,MAAA,EAAA,eAAA,EAAA;;EAAA,WAAA,GAAc,SAAS,CAAC,OAAV,CAAkB,aAAlB;;EACd,YAAA,GAAe,SAAS,CAAC,OAAV,CAAkB,cAAlB;;EACf,UAAA,GAAa,SAAS,CAAC,OAAV,CAAkB,YAAlB;;EAEb,MAAA,GAAS,OAAA,CAAQ,oCAAR;;EAET,eAAA,GAAkB;;EAClB,WAAA,GAAc;;EAEd,MAAM,CAAC,OAAP,GAAiB,QAAA,CAAC,QAAD,CAAA;AACf,QAAA,gBAAA,EAAA,YAAA,EAAA;IAAA,YAAA,GAAe,WAAW,CAAC,EAAZ,CAAe,WAAf;IACf,YAAA,GAAe;IACf,gBAAA,GAAmB;WAEnB,YAAY,CAAC,gBAAb,CAAA,CAA+B,CAAC,IAAhC,CACE,QAAA,CAAC,KAAD,CAAA;aACE,gBAAA,GAAmB;IADrB,CADF,CAGC,CAAC,IAHF,CAIE,QAAA,CAAA,CAAA,EAAA;;aAEE,UAAU,CAAC,GAAX,CAAA,CAAgB,CAAC,IAAjB,CACE,QAAA,CAAC,WAAD,CAAA;QACE,OAAO,CAAC,GAAR,CAAY,4BAAA,GAA+B,WAAW,CAAC,OAAvD;eACA,WAAW,CAAC,GAAZ,CACE,gBADF,EAEE,WAAW,CAAC,OAFd,EAGE,MAAM,CAAC,YAHT,EAIE,eAJF,EAKE,MAAM,CAAC,YALT,EAME,MAAM,CAAC,cANT,EAOE,MAAM,CAAC,sBAPT,EAQE,MAAM,CAAC,kBART,EASE,WATF,CAUC,CAAC,IAVF,CAWE,QAAA,CAAC,SAAD,CAAA;UACE,YAAA,GAAe;iBACf,OAAO,CAAC,GAAR,CAAY,6BAAA,GAAgC,SAAS,CAAC,OAAtD;QAFF,CAXF,CAcC,CAAC,IAdF,CAeE,QAAA,CAAA,CAAA;UACE,WAAW,CAAC,iBAAZ,CAA8B,YAAY,CAAC,OAA3C;iBACA,OAAO,CAAC,GAAR,CAAY,2BAAA,GAA8B,WAAW,CAAC,OAA1C,GAAoD,MAApD,GAA6D,YAAY,CAAC,OAAtF;QAFF,CAfF;MAFF,CADF;IAFF,CAJF,CA8BC,CAAC,IA9BF,CA+BE,QAAA,CAAA,CAAA,EAAA;;MAEE,YAAY,CAAC,uBAAb,CAAqC,YAAY,CAAC,OAAlD;aACA,OAAO,CAAC,GAAR,CAAY,2BAAA,GAA8B,gBAA9B,GAAiD,MAAjD,GAA0D,YAAY,CAAC,OAAnF;IAHF,CA/BF;EALe;AATjB",
  "sourcesContent": [
    "BetokenFund = artifacts.require(\"BetokenFund\")\r\nControlToken = artifacts.require(\"ControlToken\")\r\nShareToken = artifacts.require(\"ShareToken\")\r\n\r\nconfig = require \"../deployment_configs/testnet.json\"\r\n\r\ndev_fee_address = \"0xDbE011EB3fe8C77C94Cc9d9EC176BDddC937F425\"\r\nold_address = \"0x8562D0E4E2853493E5d908Ec1caAa05604d48605\"\r\n\r\nmodule.exports = (callback) ->\r\n  old_contract = BetokenFund.at(old_address)\r\n  new_contract = null\r\n  controlTokenAddr = null\r\n\r\n  old_contract.controlTokenAddr().then(\r\n    (_addr) ->\r\n      controlTokenAddr = _addr\r\n  ).then(\r\n    () ->\r\n      #Deploy new BetokenFund\r\n      ShareToken.new().then(\r\n        (_shareToken) ->\r\n          console.log(\"Created new ShareToken at \" + _shareToken.address)\r\n          BetokenFund.new(\r\n            controlTokenAddr,\r\n            _shareToken.address,\r\n            config.kyberAddress,\r\n            dev_fee_address,\r\n            config.phaseLengths,\r\n            config.commissionRate,\r\n            config.developerFeeProportion,\r\n            config.functionCallReward,\r\n            old_address\r\n          ).then(\r\n            (_instance) ->\r\n              new_contract = _instance\r\n              console.log(\"Created new BetokenFund at \" + _instance.address)\r\n          ).then(\r\n            () ->\r\n              _shareToken.transferOwnership(new_contract.address)\r\n              console.log(\"Transferred ownership of \" + _shareToken.address + \" to \" + new_contract.address)\r\n          )\r\n      )\r\n\r\n  ).then(\r\n    () ->\r\n      #Transfer ownership\r\n      old_contract.changeControlTokenOwner(new_contract.address)\r\n      console.log(\"Transferred ownership of \" + controlTokenAddr + \" to \" + new_contract.address)\r\n  )\r\n"
  ]
}