// Generated by CoffeeScript 2.2.2
(function() {
  var BetokenFund, ControlToken, config, dev_fee_address, old_address, start_cycle_number;

  BetokenFund = artifacts.require("BetokenFund");

  ControlToken = artifacts.require("ControlToken");

  config = require("../deployment_configs/testnet.json");

  dev_fee_address = "0xDbE011EB3fe8C77C94Cc9d9EC176BDddC937F425";

  old_address = "0x8562D0E4E2853493E5d908Ec1caAa05604d48605";

  start_cycle_number = 0;

  module.exports = function(callback) {
    var controlTokenAddr, new_contract, old_contract, shareTokenAddr;
    old_contract = BetokenFund.at(old_address);
    new_contract = null;
    controlTokenAddr = null;
    shareTokenAddr = null;
    return old_contract.pause().then(function() {
      return old_contract.controlTokenAddr().then(function(_addr) {
        return controlTokenAddr = _addr;
      }).then(function() {
        return old_contract.shareTokenAddr().then(function(_addr) {
          return shareTokenAddr = _addr;
        });
      });
    }).then(function() {
      //Deploy new BetokenFund
      return BetokenFund.new(controlTokenAddr, shareTokenAddr, config.kyberAddress, dev_fee_address, config.timeOfChangeMaking, config.timeOfProposalMaking, config.timeOfWaiting, config.timeOfFinalizing, config.commissionRate, config.developerFeeProportion, start_cycle_number, config.functionCallReward, config.controlTokenInflation, config.aumThreshold).then(function(_instance) { //KyberNetwork address //developerFeeAccount
        new_contract = _instance;
        return console.log("Created new BetokenFund at " + _instance.address);
      });
    }).then(function() {
      //Transfer ownership
      old_contract.changeControlTokenOwner(new_contract.address);
      return old_contract.changeShareTokenOwner(new_contract.address);
    });
  };

}).call(this);

//# sourceMappingURL=upgrade_retain_kairo_oraclize.js.map
