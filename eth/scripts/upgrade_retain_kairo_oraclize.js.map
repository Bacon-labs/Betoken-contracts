{
  "version": 3,
  "file": "upgrade_retain_kairo_oraclize.js",
  "sourceRoot": "",
  "sources": [
    "upgrade_retain_kairo_oraclize.coffee"
  ],
  "names": [],
  "mappings": ";AAAA;AAAA,MAAA,WAAA,EAAA,YAAA,EAAA,MAAA,EAAA,eAAA,EAAA,WAAA,EAAA;;EAAA,WAAA,GAAc,SAAS,CAAC,OAAV,CAAkB,aAAlB;;EACd,YAAA,GAAe,SAAS,CAAC,OAAV,CAAkB,cAAlB;;EAEf,MAAA,GAAS,OAAA,CAAQ,oCAAR;;EAET,eAAA,GAAkB;;EAClB,WAAA,GAAc;;EACd,kBAAA,GAAqB;;EAErB,MAAM,CAAC,OAAP,GAAiB,QAAA,CAAC,QAAD,CAAA;AACf,QAAA,gBAAA,EAAA,YAAA,EAAA,YAAA,EAAA;IAAA,YAAA,GAAe,WAAW,CAAC,EAAZ,CAAe,WAAf;IACf,YAAA,GAAe;IACf,gBAAA,GAAmB;IACnB,cAAA,GAAiB;WAEjB,YAAY,CAAC,KAAb,CAAA,CAAoB,CAAC,IAArB,CACE,QAAA,CAAA,CAAA;aACE,YAAY,CAAC,gBAAb,CAAA,CAA+B,CAAC,IAAhC,CACE,QAAA,CAAC,KAAD,CAAA;eACE,gBAAA,GAAmB;MADrB,CADF,CAGC,CAAC,IAHF,CAIE,QAAA,CAAA,CAAA;eACE,YAAY,CAAC,cAAb,CAAA,CAA6B,CAAC,IAA9B,CACE,QAAA,CAAC,KAAD,CAAA;iBACE,cAAA,GAAiB;QADnB,CADF;MADF,CAJF;IADF,CADF,CAYC,CAAC,IAZF,CAaE,QAAA,CAAA,CAAA,EAAA;;aAEE,WAAW,CAAC,GAAZ,CACE,gBADF,EAEE,cAFF,EAGE,MAAM,CAAC,YAHT,EAIE,eAJF,EAKE,MAAM,CAAC,kBALT,EAME,MAAM,CAAC,oBANT,EAOE,MAAM,CAAC,aAPT,EAQE,MAAM,CAAC,gBART,EASE,MAAM,CAAC,cATT,EAUE,MAAM,CAAC,sBAVT,EAWE,kBAXF,EAYE,MAAM,CAAC,kBAZT,EAaE,MAAM,CAAC,qBAbT,EAcE,MAAM,CAAC,YAdT,CAeC,CAAC,IAfF,CAgBE,QAAA,CAAC,SAAD,CAAA,EAAA;QACE,YAAA,GAAe;eACf,OAAO,CAAC,GAAR,CAAY,6BAAA,GAAgC,SAAS,CAAC,OAAtD;MAFF,CAhBF;IAFF,CAbF,CAmCC,CAAC,IAnCF,CAoCE,QAAA,CAAA,CAAA,EAAA;;MAEE,YAAY,CAAC,uBAAb,CAAqC,YAAY,CAAC,OAAlD;aACA,YAAY,CAAC,qBAAb,CAAmC,YAAY,CAAC,OAAhD;IAHF,CApCF;EANe;AATjB",
  "sourcesContent": [
    "BetokenFund = artifacts.require(\"BetokenFund\")\r\nControlToken = artifacts.require(\"ControlToken\")\r\n\r\nconfig = require \"../deployment_configs/testnet.json\"\r\n\r\ndev_fee_address = \"0xDbE011EB3fe8C77C94Cc9d9EC176BDddC937F425\"\r\nold_address = \"0x8562D0E4E2853493E5d908Ec1caAa05604d48605\"\r\nstart_cycle_number = 0\r\n\r\nmodule.exports = (callback) ->\r\n  old_contract = BetokenFund.at(old_address)\r\n  new_contract = null\r\n  controlTokenAddr = null\r\n  shareTokenAddr = null\r\n\r\n  old_contract.pause().then(\r\n    () ->\r\n      old_contract.controlTokenAddr().then(\r\n        (_addr) ->\r\n          controlTokenAddr = _addr\r\n      ).then(\r\n        () ->\r\n          old_contract.shareTokenAddr().then(\r\n            (_addr) ->\r\n              shareTokenAddr = _addr\r\n          )\r\n      )\r\n  ).then(\r\n    () ->\r\n      #Deploy new BetokenFund\r\n      BetokenFund.new(\r\n        controlTokenAddr,\r\n        shareTokenAddr,\r\n        config.kyberAddress, #KyberNetwork address\r\n        dev_fee_address, #developerFeeAccount\r\n        config.timeOfChangeMaking,\r\n        config.timeOfProposalMaking,\r\n        config.timeOfWaiting,\r\n        config.timeOfFinalizing,\r\n        config.commissionRate,\r\n        config.developerFeeProportion,\r\n        start_cycle_number,\r\n        config.functionCallReward,\r\n        config.controlTokenInflation,\r\n        config.aumThreshold\r\n      ).then(\r\n        (_instance) ->\r\n          new_contract = _instance\r\n          console.log(\"Created new BetokenFund at \" + _instance.address)\r\n      )\r\n  ).then(\r\n    () ->\r\n      #Transfer ownership\r\n      old_contract.changeControlTokenOwner(new_contract.address)\r\n      old_contract.changeShareTokenOwner(new_contract.address)\r\n  )\r\n"
  ]
}